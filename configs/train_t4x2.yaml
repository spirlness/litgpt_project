# T4 x2 (15GB each) optimized config
out_dir: ./checkpoints
precision: 16-mixed
tokenizer_dir: ./data/tokenizer

# Multi-GPU settings with NCCL optimization for Kaggle
devices: 2
num_nodes: 1

data:
  class_path: litgpt.data.TextFiles
  init_args:
    train_data_path: ./data/custom_text/train
    val_data_path: ./data/custom_text/val
    num_workers: 0

train:
  global_batch_size: 128
  log_interval: 1
  max_tokens: 1000000000  # Increased to 1B tokens to allow resuming from 65M+
  lr_warmup_steps: 10
  micro_batch_size: 1
  save_interval: 1000
  gradient_checkpointing: true
  max_norm: 1.0
  max_seq_length: 512

optimizer:
  class_path: torch.optim.AdamW
  init_args:
    lr: 0.0003
    weight_decay: 0.01
    # Enable 8-bit optimizer to save memory
    bnb_optimizer_type: "AdamW8bit"
